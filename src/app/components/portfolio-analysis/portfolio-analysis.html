<div class="portfolio-container">
    <div class="header">
        <h1>Analiza Portfela</h1>
        <p>Zbuduj swÃ³j portfel obligacji i sprawdÅº przewidywany zysk w czasie.</p>
    </div>

    <div class="input-section">
        <h2 class="section-title">TwÃ³j Portfel</h2>

        @for (item of portfolio; track $index) {
        <div class="bond-row">
            <div class="form-group">
                <label>Rodzaj Obligacji</label>
                <select [(ngModel)]="item.bondType" (ngModelChange)="calculate()" class="form-control">
                    @for (bond of availableBonds; track bond.type) {
                    <option [value]="bond.type">{{ bond.name }} ({{bond.type}})</option>
                    }
                </select>
            </div>
            <div class="form-group">
                <label>Kwota (PLN)</label>
                <input type="number" [(ngModel)]="item.amount" (ngModelChange)="calculate()" step="100" min="100"
                    class="form-control">
            </div>
            <button class="remove-btn" (click)="removeBond($index)" [disabled]="portfolio.length <= 1"
                title="UsuÅ„ pozycjÄ™">
                âœ•
            </button>
        </div>
        }

        <button class="add-btn" (click)="addBond()">+ Dodaj kolejnÄ… obligacjÄ™</button>

        <div class="horizon-section">
            <div class="form-group">
                <label>Horyzont inwestycyjny: <strong>{{ investmentHorizon }} miesiÄ™cy</strong></label>
                <div class="horizon-control">
                    <input type="range" min="1" max="120" step="1" [(ngModel)]="investmentHorizon"
                        (ngModelChange)="calculate()" class="horizon-slider">
                </div>
            </div>
        </div>
    </div>

    <div class="results-section">
        <div class="summary-cards">
            <div class="summary-card">
                <span class="summary-label">CaÅ‚kowita Inwestycja</span>
                <span class="summary-value">{{ summary.totalInvestment | number:'1.0-0' }} PLN</span>
            </div>
            <div class="summary-card">
                <span class="summary-label">Zysk Brutto</span>
                <span class="summary-value profit">+{{ summary.totalProfit | number:'1.2-2' }} PLN</span>
            </div>
            <div class="summary-card">
                <span class="summary-label">Podatek Belki</span>
                <span class="summary-value tax">-{{ summary.tax | number:'1.2-2' }} PLN</span>
            </div>
            <div class="summary-card">
                <span class="summary-label">Zysk Netto</span>
                <span class="summary-value profit">+{{ summary.netProfit | number:'1.2-2' }} PLN</span>
            </div>
        </div>

        <div class="tips-section" *ngIf="optimizationTip">
            <div class="tips-title">ðŸ’¡ WskazÃ³wka optymalizacyjna</div>
            <p class="tip-content">{{ optimizationTip }}</p>
        </div>

        <br>

        <div class="charts-grid">
            <div class="chart-card">
                <h3 class="section-title">Struktura Portfela</h3>
                <div class="chart-container">
                    <canvas baseChart [data]="pieChartData" [options]="pieChartOptions" [type]="pieChartType">
                    </canvas>
                </div>
            </div>
            <div class="chart-card">
                <h3 class="section-title">Potencjalny Zysk Netto ({{investmentHorizon}} mies.)</h3>
                <div class="chart-container">
                    <canvas baseChart [data]="barChartData" [options]="barChartOptions" [type]="barChartType">
                    </canvas>
                </div>
            </div>
        </div>
    </div>
</div>